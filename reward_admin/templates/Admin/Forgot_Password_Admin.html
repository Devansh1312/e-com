{% extends 'base-other-page.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Forgot Password" %}{% endblock %}

{% block content %}
<div class="row m-0">
    <div class="col-12 p-0">    
        <div class="login-card">
            <div>
                <div>
                    <a class="logo" href="{% url 'adminlogin' %}">
                        <img class="img-fluid for-light" style="width: 240px; height: 70px;" src="{{ website_logo }}" alt="loginpage">
                        <img class="img-fluid for-dark" src="{{ website_logo }}" alt="loginpage">
                    </a>
                </div>
                <div class="login-main"> 
                    <form class="theme-form" method="post" novalidate>
                        {% csrf_token %}
                        <h4>{% trans "Reset Your Password" %}</h4>
                        <p>{% trans "Enter your email address to receive a verification code" %}</p>
                    
                        <div class="form-group">
                            <label class="col-form-label">{% trans "Email Address" %}</label>
                            <input type="email" name="email" class="form-control" required 
                                   placeholder="{% trans 'Enter your registered email' %}"
                                   value="{{ request.POST.email }}">
                            {% if form.errors.email %}
                                <div class="text-danger">
                                    {{ form.errors.email }}
                                </div>
                            {% endif %}
                        </div>

                        <div class="form-group mb-0">
                            <div class="text-end mt-3">
                                <button class="btn btn-primary btn-block w-100" type="submit">
                                    {% trans "Send Verification Code" %}
                                </button>
                            </div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <a href="{% url 'adminlogin' %}" class="text-muted">
                                {% trans "Back to Login" %}
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    $('form.theme-form').submit(function(e) {
        var emailInput = $('input[name="email"]');
        var emailValue = emailInput.val().trim();
        var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        // Remove previous error styling
        emailInput.removeClass('is-invalid');
        $('.email-error').remove();
        
        // Validate email
        if (!emailValue) {
            e.preventDefault();
            emailInput.addClass('is-invalid');
            emailInput.after('<div class="text-danger email-error">{% trans "Email is required" %}</div>');
        } else if (!emailRegex.test(emailValue)) {
            e.preventDefault();
            emailInput.addClass('is-invalid');
            emailInput.after('<div class="text-danger email-error">{% trans "Please enter a valid email address" %}</div>');
        }
    });
    
    // Clear error when user starts typing
    $('input[name="email"]').on('input', function() {
        $(this).removeClass('is-invalid');
        $('.email-error').remove();
    });
});
</script>
{% endblock %}